<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>agrotech lab - 11&nbsp; Control</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../tutorials/digital-read-write.html" rel="next">
<link href="../tutorials/electronics-class-2.html" rel="prev">
<link href="..//archive/images/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/iconify-1.0.0-beta.2/iconify-icon.min.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../custom.scss">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../tutorials/first-programs.html"><strong>Lectures</strong></a></li><li class="breadcrumb-item"><a href="../tutorials/control.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Control</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../archive/images/site-logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">agrotech lab</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://yairmau.com/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-house-fill"></i></a>
    <a href="../sources.html" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-bookmark-fill"></i></a>
    <a href="../things-to-remember.html" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-asterisk"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text"><strong>Start here</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../arduino-intro-and-links.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Arduino intro</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/arduino_IDE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Arduino IDE</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/install_firebeetle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Install FireBeetle (ESP32)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text"><strong>Basics</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/breadboard.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Breadboard</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/basic-electronics-concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Basic Electronics Concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/firebeetle_documentation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">FireBeetle 2 ESP32-E</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/libraries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Libraries</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text"><strong>Lectures</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/first-programs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">First programs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/electronics-class.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Electronics Class</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/electronics-class-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Electronics Class 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/control.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/digital-read-write.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Reading digital and analog</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/digital-sensors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Digital sensors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/cloud-connectivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Cloud connectivity</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text"><strong>Running simple programs</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/merging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Code Merging</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/RGB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">RGB LED</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text"><strong>Electronics</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/relay.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Switches, Relays, Transistors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/soldering-and-wires.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Soldering and Wires</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/electronics-class-old.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Electronics Class Old</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text"><strong>Sensors and comm</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/pulse-sensors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Pulse sensors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/MQTT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">MQTT</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/deep_sleep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Deep Sleep</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/esp_now.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">ESP-NOW</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/OLED.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">OLED screen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/python-matlab-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Basic Data Analysis with Python and Matlab</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/API-thingspeak-python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">API to download Thingspeak data with Python</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text"><strong>Agro stuff</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/water-and-energy-balances.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Water and Energy Balances</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/psychrometric-chart-and-evaporative-cooling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Psychrometric Chart and Evaporative Cooling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text"><strong>Assignments</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/assignment1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Assignment 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/assignment2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Assignment 2</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text"><strong>Resources</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title"> Resources</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
 <span class="menu-text"><strong>Projects</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title"> Projects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projects/borrowing-equipment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Borrowing equipment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projects/final-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Final Project</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projects/examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Example projects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projects/greenhouse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">The Smart Greenhouse</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#not-so-good-led-dimmer" id="toc-not-so-good-led-dimmer" class="nav-link active" data-scroll-target="#not-so-good-led-dimmer"><span class="header-section-number">11.0.1</span> Not-so-good LED dimmer</a></li>
  <li><a href="#pwm-with-esp32" id="toc-pwm-with-esp32" class="nav-link" data-scroll-target="#pwm-with-esp32"><span class="header-section-number">11.1</span> PWM with ESP32</a></li>
  <li><a href="#relay" id="toc-relay" class="nav-link" data-scroll-target="#relay"><span class="header-section-number">11.2</span> Relay</a></li>
  <li><a href="#sht31-sensor" id="toc-sht31-sensor" class="nav-link" data-scroll-target="#sht31-sensor"><span class="header-section-number">11.3</span> SHT31 Sensor</a>
  <ul class="collapse">
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries"><span class="header-section-number">11.3.1</span> Libraries</a></li>
  <li><a href="#wiring" id="toc-wiring" class="nav-link" data-scroll-target="#wiring"><span class="header-section-number">11.3.2</span> Wiring</a></li>
  <li><a href="#code" id="toc-code" class="nav-link" data-scroll-target="#code"><span class="header-section-number">11.3.3</span> Code</a></li>
  </ul></li>
  <li><a href="#challenges" id="toc-challenges" class="nav-link" data-scroll-target="#challenges"><span class="header-section-number">11.4</span> Challenges</a>
  <ul class="collapse">
  <li><a href="#high-temperature-activates-fan" id="toc-high-temperature-activates-fan" class="nav-link" data-scroll-target="#high-temperature-activates-fan"><span class="header-section-number">11.4.1</span> High temperature activates fan</a></li>
  <li><a href="#traffic-lights" id="toc-traffic-lights" class="nav-link" data-scroll-target="#traffic-lights"><span class="header-section-number">11.4.2</span> Traffic lights</a></li>
  <li><a href="#bonus" id="toc-bonus" class="nav-link" data-scroll-target="#bonus"><span class="header-section-number">11.4.3</span> Bonus</a></li>
  </ul></li>
  <li><a href="#extra-codes-and-examples" id="toc-extra-codes-and-examples" class="nav-link" data-scroll-target="#extra-codes-and-examples"><span class="header-section-number">11.5</span> Extra codes and examples</a>
  <ul class="collapse">
  <li><a href="#serial-read-and-blink" id="toc-serial-read-and-blink" class="nav-link" data-scroll-target="#serial-read-and-blink"><span class="header-section-number">11.5.1</span> Serial read and blink</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<script src="https://code.iconify.design/iconify-icon/1.0.1/iconify-icon.min.js"></script>

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../tutorials/first-programs.html"><strong>Lectures</strong></a></li><li class="breadcrumb-item"><a href="../tutorials/control.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Control</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Control</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- ---
title: ""
echo: false
jupyter: python3
section-divs: false
--- -->
<section id="not-so-good-led-dimmer" class="level3" data-number="11.0.1">
<h3 data-number="11.0.1" class="anchored" data-anchor-id="not-so-good-led-dimmer"><span class="header-section-number">11.0.1</span> Not-so-good LED dimmer</h3>
<p>As we saw last time, we can use a potentiometer to control the brightness of an LED or another output device. Add this potentiometer in series in the circuit you have just built, turn the knob and see what happens.</p>
<details>
<summary>
see diagram
</summary>
<img src="../archive/figures/diagrams/led-resistor-potentiometer-esp32_schem.png" class="img-fluid">
</details>
<details>
<summary>
see wiring scheme
</summary>
<img src="../archive/figures/diagrams/led-resistor-potentiometer-esp32_bb.png" class="img-fluid">
</details>
</section>
<section id="pwm-with-esp32" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="pwm-with-esp32"><span class="header-section-number">11.1</span> PWM with ESP32</h2>
<p>Pulse-width modulation (PWM) is a method of controlling the average power delivered by an electrical signal. The average value of voltage (and current) fed to the load is controlled by switching the supply between 0 and 100% at a rate faster than it takes the load to change significantly. <strong>PWM is a technique for getting analog results with digital means.</strong> Digital control is used to create a square wave, a signal switched between on and off. This on-off pattern can simulate voltages in between the full Vcc of the board and off by changing the portion of time the signal spends on versus the time that the signal spends off. PWM is used in many applications such as controlling motor speed, heat output of heaters and variable speed fan controllers.</p>
<p><img src="https://cdn.sparkfun.com/assets/f/9/c/8/a/512e869bce395fbc64000002.JPG" class="img-fluid"></p>
<p>Use the following code to activate LED pin with PWM.</p>
<button class="btn btn-outline-dark  rounded" type="button" data-bs-toggle="collapse" data-bs-target="#PWM-basicino" aria-expanded="false" aria-controls="PWM-basicino">
    <i class="bi bi-toggles"></i> Toggle code
    </button>
     <a class="btn btn-outline-dark rounded" ,="" href="../archive/code/PWM-basic.ino" download="" target="_blank" rel="noopener noreferrer">
        <i class="bi bi-download"></i> Download code
    </a>

            <div class="collapse" id="PWM-basicino">
            <div class="card card-body border-0">
        
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">/*</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">  Rui Santos &amp; Sara Santos - Random Nerd Tutorials</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">  Complete project details at https://RandomNerdTutorials.com/esp32-pwm-arduino-ide/</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">  Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files.  </span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">  The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">*/</span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">// the number of the LED pin</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="dt">const</span> <span class="dt">int</span> ledPin <span class="op">=</span> D9<span class="op">;</span>  <span class="co">// 16 corresponds to GPIO 16</span></span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="dt">void</span> setup<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>  <span class="co">// set the LED as an output</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>  pinMode<span class="op">(</span>ledPin<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="op">}</span></span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="dt">void</span> loop<span class="op">(){</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>  <span class="co">// increase the LED brightness</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>  <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> dutyCycle <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> dutyCycle <span class="op">&lt;=</span> <span class="dv">255</span><span class="op">;</span> dutyCycle<span class="op">++){</span>   </span>
<span id="cb1-19"><a href="#cb1-19"></a>    <span class="co">// changing the LED brightness with PWM</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>    analogWrite<span class="op">(</span>ledPin<span class="op">,</span> dutyCycle<span class="op">);</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>    delay<span class="op">(</span><span class="dv">15</span><span class="op">);</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>  <span class="op">}</span></span>
<span id="cb1-23"><a href="#cb1-23"></a></span>
<span id="cb1-24"><a href="#cb1-24"></a>  <span class="co">// decrease the LED brightness</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>  <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> dutyCycle <span class="op">=</span> <span class="dv">255</span><span class="op">;</span> dutyCycle <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> dutyCycle<span class="op">--){</span></span>
<span id="cb1-26"><a href="#cb1-26"></a>    <span class="co">// changing the LED brightness with PWM</span></span>
<span id="cb1-27"><a href="#cb1-27"></a>    analogWrite<span class="op">(</span>ledPin<span class="op">,</span> dutyCycle<span class="op">);</span></span>
<span id="cb1-28"><a href="#cb1-28"></a>    delay<span class="op">(</span><span class="dv">15</span><span class="op">);</span></span>
<span id="cb1-29"><a href="#cb1-29"></a>  <span class="op">}</span></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

            </div>
            </div>
            
<p><br> If for some reason you are working with an older version of ESP32 board manager (2.0.17 or lower), then use the code below. If you have no idea what I’m talking about, just ignore this.</p>
<button class="btn btn-outline-dark  rounded" type="button" data-bs-toggle="collapse" data-bs-target="#PWM-basic-oldino" aria-expanded="false" aria-controls="PWM-basic-oldino">
    <i class="bi bi-toggles"></i> Toggle code
    </button>
     <a class="btn btn-outline-dark rounded" ,="" href="../archive/code/PWM-basic-old.ino" download="" target="_blank" rel="noopener noreferrer">
        <i class="bi bi-download"></i> Download code
    </a>

            <div class="collapse" id="PWM-basic-oldino">
            <div class="card card-body border-0">
        
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">// the number of the LED pin</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="dt">const</span> <span class="dt">int</span> ledPin <span class="op">=</span> D9<span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">// setting PWM properties</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="dt">const</span> <span class="dt">int</span> freq <span class="op">=</span> <span class="dv">5000</span><span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="dt">const</span> <span class="dt">int</span> ledChannel <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="dt">const</span> <span class="dt">int</span> resolution <span class="op">=</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="cb2-8"><a href="#cb2-8"></a> </span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="dt">void</span> setup<span class="op">(){</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>  <span class="co">// configure LED PWM functionalitites</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>  ledcSetup<span class="op">(</span>ledChannel<span class="op">,</span> freq<span class="op">,</span> resolution<span class="op">);</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>  </span>
<span id="cb2-13"><a href="#cb2-13"></a>  <span class="co">// attach the channel to the GPIO to be controlled</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>  ledcAttachPin<span class="op">(</span>ledPin<span class="op">,</span> ledChannel<span class="op">);</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="op">}</span></span>
<span id="cb2-16"><a href="#cb2-16"></a> </span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="dt">void</span> loop<span class="op">(){</span></span>
<span id="cb2-18"><a href="#cb2-18"></a>  <span class="co">// increase the LED brightness</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>  <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> dutyCycle <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> dutyCycle <span class="op">&lt;=</span> <span class="dv">255</span><span class="op">;</span> dutyCycle<span class="op">++){</span>   </span>
<span id="cb2-20"><a href="#cb2-20"></a>    <span class="co">// changing the LED brightness with PWM</span></span>
<span id="cb2-21"><a href="#cb2-21"></a>    ledcWrite<span class="op">(</span>ledChannel<span class="op">,</span> dutyCycle<span class="op">);</span></span>
<span id="cb2-22"><a href="#cb2-22"></a>    delay<span class="op">(</span><span class="dv">15</span><span class="op">);</span></span>
<span id="cb2-23"><a href="#cb2-23"></a>  <span class="op">}</span></span>
<span id="cb2-24"><a href="#cb2-24"></a></span>
<span id="cb2-25"><a href="#cb2-25"></a>  <span class="co">// decrease the LED brightness</span></span>
<span id="cb2-26"><a href="#cb2-26"></a>  <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> dutyCycle <span class="op">=</span> <span class="dv">255</span><span class="op">;</span> dutyCycle <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> dutyCycle<span class="op">--){</span></span>
<span id="cb2-27"><a href="#cb2-27"></a>    <span class="co">// changing the LED brightness with PWM</span></span>
<span id="cb2-28"><a href="#cb2-28"></a>    ledcWrite<span class="op">(</span>ledChannel<span class="op">,</span> dutyCycle<span class="op">);</span>   </span>
<span id="cb2-29"><a href="#cb2-29"></a>    delay<span class="op">(</span><span class="dv">15</span><span class="op">);</span></span>
<span id="cb2-30"><a href="#cb2-30"></a>  <span class="op">}</span></span>
<span id="cb2-31"><a href="#cb2-31"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

            </div>
            </div>
            
</section>
<section id="relay" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="relay"><span class="header-section-number">11.2</span> Relay</h2>
<p><img src="../archive/figures/relay-module.jpg" class="img-fluid"></p>
<p>A relay is an electromagnetic switch that opens and closes circuits electromechanically or electronically. A relatively small electric current that can turn on or off a much larger electric current operates a relay.</p>
<p>The right side in the image above has a set of four pins and a set of three pins. The top set consists of:</p>
<ul>
<li><code>VCC</code> should be connected to the ESP32 VCC (5 volts)</li>
<li><code>GND</code> connects to the ESP32 GND.</li>
<li><code>IN1</code> and <code>IN2</code> are input pins, used to control the bottom and top relays, respectively, and should be connected to a GPIO pin in the ESP32.</li>
</ul>
<p>The terminals on the left are connected to the <code>load</code>, the equipment that consumes power. The signal you send to the IN pins determines whether the relay is active or not. The relay is triggered when the input goes below about 2V. This means that you’ll have the following scenarios:</p>
<ul>
<li><strong>Normally Closed (NC) configuration</strong>:
<ul>
<li>HIGH signal – current is flowing</li>
<li>LOW signal – current is not flowing</li>
</ul></li>
<li><strong>Normally Open (NO) configuration</strong>:
<ul>
<li>HIGH signal – current is not flowing</li>
<li>LOW signal – current is flowing</li>
</ul></li>
</ul>
<p>Whether you use the NC or NO configuration, you should always connect one of them to the <code>COM</code> (common) terminal.</p>
<p>You should use a normally closed configuration when the current should be flowing most of the time, and you only want to stop it occasionally.</p>
<p>Use a normally open configuration when you want the current to flow occasionally (for example, to turn on a lamp occasionally).</p>
<p><img src="../archive/figures/Relay-2-ch-channel-module-input-pins-pinout.jpeg" class="img-fluid"></p>
<p>The other set of three pins (on the left in the figure above) are GND, VCC, and JD-VCC. The JD-VCC pin powers the electromagnet of the relay. Notice that the module has a jumper cap connecting the VCC and JD-VCC pins; the one shown here is yellow, but yours may be a different color.</p>
<p>With the jumper cap on, the VCC and JD-VCC pins are connected. That means the relay electromagnet is directly powered from the ESP32 power pin, so the relay module and the ESP32 circuits are not physically isolated from each other.</p>
<p>Without the jumper cap, you need to provide an independent power source to power up the relay’s electromagnet through the JD-VCC pin. That configuration physically isolates the relays from the ESP32 with the module’s built-in optocoupler, which prevents damage to the ESP32 in case of electrical spikes.</p>
<p><img src="../archive/figures/relay-esp32-wiring.png" class="img-fluid"></p>
<p>The figure above shows in a very simple way that the relay behaves like a switch with respect to the top circuit.</p>
<div class="alert alert-danger">
You should <strong>NOT</strong> build the above circuit, since it is a high voltage circuit (220 V). In class we will use 5, 12 or 24 volts.
</div>
<p>Let’s make an LED blink, but now using a relay. The code below is the same you used to make the LED blink, when it got its energy from pin <code>A4</code>. This time, we will use <code>A4</code> to signal the relay to open or close the circuit.</p>
<button class="btn btn-outline-dark  rounded" type="button" data-bs-toggle="collapse" data-bs-target="#digital-writeino" aria-expanded="false" aria-controls="digital-writeino">
    <i class="bi bi-toggles"></i> Toggle code
    </button>
     <a class="btn btn-outline-dark rounded" ,="" href="../archive/code/digital-write.ino" download="" target="_blank" rel="noopener noreferrer">
        <i class="bi bi-download"></i> Download code
    </a>

            <div class="collapse" id="digital-writeino">
            <div class="card card-body border-0">
        
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb3-1"><a href="#cb3-1"></a><span class="dt">int</span> LED_pin <span class="op">=</span> A4<span class="op">;</span></span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">// the setup function runs once when you press reset or power the board</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="dt">void</span> setup<span class="op">()</span> <span class="op">{</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="co">// initialize digital pin LED_pin as an output.</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  pinMode<span class="op">(</span>LED_pin<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="op">}</span></span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">// the loop function runs over and over again forever</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="dt">void</span> loop<span class="op">()</span> <span class="op">{</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>  digitalWrite<span class="op">(</span>LED_pin<span class="op">,</span> HIGH<span class="op">);</span>   <span class="co">// turn the LED on (HIGH is the voltage level)</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>  delay<span class="op">(</span><span class="dv">3000</span><span class="op">);</span>                       <span class="co">// wait for a second</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>  digitalWrite<span class="op">(</span>LED_pin<span class="op">,</span> LOW<span class="op">);</span>    <span class="co">// turn the LED off by making the voltage LOW</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>  delay<span class="op">(</span><span class="dv">1000</span><span class="op">);</span>                       <span class="co">// wait for a second</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

            </div>
            </div>
            
<details>
<summary>
see diagram
</summary>
<img src="../archive/figures/diagrams/relay-led-esp32_schem.png" class="img-fluid">
</details>
<details>
<summary>
see wiring scheme
</summary>
<img src="../archive/figures/diagrams/relay-led-esp32_bb.png" class="img-fluid">
</details>
</section>
<section id="sht31-sensor" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="sht31-sensor"><span class="header-section-number">11.3</span> SHT31 Sensor</h2>
<p>The SHT31 is a high-precision temperature and humidity sensor that can be used in a wide range of applications. It measures temperature and humidity using a capacitive humidity sensor and a band-gap temperature sensor. It has a wide measurement range of -40°C to 125°C for temperature and 0-100% for relative humidity. The SHT31 is a digital sensor, which means it communicates with the microcontroller over a digital interface. See more details on the <a href="https://github.com/adafruit/Adafruit_SHT31">Adafruit’s github page for the SHT31</a> and full specs on the <a href="https://www.mouser.com/datasheet/2/682/Sensirion_Humidity_Sensors_SHT3x_Datasheet_digital-971521.pdf">SHT31 datasheet</a>.</p>
<section id="libraries" class="level3" data-number="11.3.1">
<h3 data-number="11.3.1" class="anchored" data-anchor-id="libraries"><span class="header-section-number">11.3.1</span> Libraries</h3>
<p>To use the SHT31 sensor with an ESP32 microcontroller, we will need to use the Adafruit_SHT31 library. This library is specifically designed to work with the SHT31 sensor and makes it easy to read temperature and humidity values from the sensor.</p>
<p>To install the library, follow these steps:</p>
<ol type="1">
<li>Open the Arduino IDE</li>
<li>Go to <strong>Sketch &gt; Include Library &gt; Manage Libraries</strong></li>
<li>Search for “Adafruit_SHT31” and click the <strong>Install</strong> button</li>
<li>Wait for the library to install</li>
</ol>
</section>
<section id="wiring" class="level3" data-number="11.3.2">
<h3 data-number="11.3.2" class="anchored" data-anchor-id="wiring"><span class="header-section-number">11.3.2</span> Wiring</h3>
<p>To connect the SHT31 sensor to the ESP32 microcontroller, we will need to use four wires: VCC, GND, SDA, and SCL. Here is a table that shows how to connect the wires:</p>
<table class="table">
<thead>
<tr class="header">
<th>SHT31 Pin</th>
<th>ESP32 Pin</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>VCC</td>
<td>3V3</td>
</tr>
<tr class="even">
<td>GND</td>
<td>GND</td>
</tr>
<tr class="odd">
<td>SDA</td>
<td>GPIO21</td>
</tr>
<tr class="even">
<td>SCL</td>
<td>GPIO22</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> The ESP32’s 3V3 pin provides 3.3 volts of power, which is the correct voltage for the SHT31 sensor. Do not use the 5V pin, as it will damage the sensor.</p>
</section>
<section id="code" class="level3" data-number="11.3.3">
<h3 data-number="11.3.3" class="anchored" data-anchor-id="code"><span class="header-section-number">11.3.3</span> Code</h3>
<p>Here is the code for reading temperature and humidity values from the SHT31 sensor.</p>
<button class="btn btn-outline-dark  rounded" type="button" data-bs-toggle="collapse" data-bs-target="#sht31ino" aria-expanded="false" aria-controls="sht31ino">
    <i class="bi bi-toggles"></i> Toggle code
    </button>
     <a class="btn btn-outline-dark rounded" ,="" href="../archive/code/sht31.ino" download="" target="_blank" rel="noopener noreferrer">
        <i class="bi bi-download"></i> Download code
    </a>

            <div class="collapse" id="sht31ino">
            <div class="card card-body border-0">
        
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">/*</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"> * This program is a modification of</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"> * http://www.esp32learning.com/code/esp32-and-sht31-sensor-example.php</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"> */</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="pp">#include </span><span class="im">&lt;Arduino.h&gt;</span><span class="pp">   </span><span class="co">// Include the Arduino library</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="pp">#include </span><span class="im">&lt;Wire.h&gt;</span><span class="pp">      </span><span class="co">// Include the Wire library for I2C communication</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="pp">#include </span><span class="im">"Adafruit_SHT31.h"</span><span class="pp"> </span><span class="co">// Include the SHT31 library from Adafruit</span></span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a>Adafruit_SHT31 sht31 <span class="op">=</span> Adafruit_SHT31<span class="op">();</span> <span class="co">// Create an instance of the SHT31 object</span></span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="dt">void</span> setup<span class="op">()</span> <span class="op">{</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>  Serial<span class="op">.</span>begin<span class="op">(</span><span class="dv">115200</span><span class="op">);</span>        <span class="co">// Initialize the serial communication with a baud rate of 112500</span></span>
<span id="cb4-13"><a href="#cb4-13"></a>  <span class="cf">if</span> <span class="op">(!</span> sht31<span class="op">.</span>begin<span class="op">(</span><span class="bn">0x44</span><span class="op">))</span> <span class="op">{</span>   <span class="co">// Check if SHT31 is connected and start it with address 0x44</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>    <span class="co">// Print an error message if SHT31 is not found</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>    Serial<span class="op">.</span>println<span class="op">(</span><span class="st">"Couldn't find SHT31"</span><span class="op">);</span></span>
<span id="cb4-16"><a href="#cb4-16"></a>    <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> delay<span class="op">(</span><span class="dv">1</span><span class="op">);</span>  <span class="co">// Wait indefinitely</span></span>
<span id="cb4-17"><a href="#cb4-17"></a>  <span class="op">}</span></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="op">}</span></span>
<span id="cb4-19"><a href="#cb4-19"></a></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="dt">void</span> loop<span class="op">()</span> <span class="op">{</span></span>
<span id="cb4-21"><a href="#cb4-21"></a>  <span class="co">// Read temperature from SHT31 and assign it to "temperature"</span></span>
<span id="cb4-22"><a href="#cb4-22"></a>  <span class="dt">float</span> temperature <span class="op">=</span> sht31<span class="op">.</span>readTemperature<span class="op">();</span> </span>
<span id="cb4-23"><a href="#cb4-23"></a>  <span class="co">// Read relative humidity from SHT31 and assign it to "humidity"</span></span>
<span id="cb4-24"><a href="#cb4-24"></a>  <span class="dt">float</span> humidity <span class="op">=</span> sht31<span class="op">.</span>readHumidity<span class="op">();</span></span>
<span id="cb4-25"><a href="#cb4-25"></a></span>
<span id="cb4-26"><a href="#cb4-26"></a>  <span class="cf">if</span> <span class="op">(!</span> isnan<span class="op">(</span>temperature<span class="op">))</span> <span class="op">{</span>     <span class="co">// Check if t is not NaN (not a number)</span></span>
<span id="cb4-27"><a href="#cb4-27"></a>    Serial<span class="op">.</span>print<span class="op">(</span><span class="st">"temp_deg_C:"</span><span class="op">);</span>  <span class="co">// Print temperature label</span></span>
<span id="cb4-28"><a href="#cb4-28"></a>    Serial<span class="op">.</span>print<span class="op">(</span>temperature<span class="op">);</span>    <span class="co">// Print temperature value</span></span>
<span id="cb4-29"><a href="#cb4-29"></a>    Serial<span class="op">.</span>print<span class="op">(</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span><span class="op">);</span>           <span class="co">// Write a tab space</span></span>
<span id="cb4-30"><a href="#cb4-30"></a>  <span class="op">}</span> </span>
<span id="cb4-31"><a href="#cb4-31"></a>  <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb4-32"><a href="#cb4-32"></a>    <span class="co">// Print an error message if temperature reading fails</span></span>
<span id="cb4-33"><a href="#cb4-33"></a>    Serial<span class="op">.</span>println<span class="op">(</span><span class="st">"Failed to read temperature"</span><span class="op">);</span></span>
<span id="cb4-34"><a href="#cb4-34"></a>  <span class="op">}</span></span>
<span id="cb4-35"><a href="#cb4-35"></a></span>
<span id="cb4-36"><a href="#cb4-36"></a>  <span class="cf">if</span> <span class="op">(!</span> isnan<span class="op">(</span>humidity<span class="op">))</span> <span class="op">{</span>        <span class="co">// Check if h is not NaN (not a number)</span></span>
<span id="cb4-37"><a href="#cb4-37"></a>    Serial<span class="op">.</span>print<span class="op">(</span><span class="st">"rel_hum_%:"</span><span class="op">);</span>   <span class="co">// Print humidity label</span></span>
<span id="cb4-38"><a href="#cb4-38"></a>    Serial<span class="op">.</span>print<span class="op">(</span>humidity<span class="op">);</span>       <span class="co">// Print humidity value</span></span>
<span id="cb4-39"><a href="#cb4-39"></a>  <span class="op">}</span> </span>
<span id="cb4-40"><a href="#cb4-40"></a>  <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb4-41"><a href="#cb4-41"></a>    <span class="co">// Print an error message if humidity reading fails</span></span>
<span id="cb4-42"><a href="#cb4-42"></a>    Serial<span class="op">.</span>println<span class="op">(</span><span class="st">"Failed to read humidity"</span><span class="op">);</span></span>
<span id="cb4-43"><a href="#cb4-43"></a>  <span class="op">}</span></span>
<span id="cb4-44"><a href="#cb4-44"></a></span>
<span id="cb4-45"><a href="#cb4-45"></a>  Serial<span class="op">.</span>println<span class="op">();</span>    <span class="co">// Break line</span></span>
<span id="cb4-46"><a href="#cb4-46"></a>  delay<span class="op">(</span><span class="dv">1000</span><span class="op">);</span>         <span class="co">// Wait 1 second</span></span>
<span id="cb4-47"><a href="#cb4-47"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

            </div>
            </div>
            
</section>
</section>
<section id="challenges" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="challenges"><span class="header-section-number">11.4</span> Challenges</h2>
<section id="high-temperature-activates-fan" class="level3" data-number="11.4.1">
<h3 data-number="11.4.1" class="anchored" data-anchor-id="high-temperature-activates-fan"><span class="header-section-number">11.4.1</span> High temperature activates fan</h3>
<p>You will receive a low-voltage fan. Build a control system that turns the fan on if temperature goes above a given threshold, e.g.&nbsp;30 °C.</p>
</section>
<section id="traffic-lights" class="level3" data-number="11.4.2">
<h3 data-number="11.4.2" class="anchored" data-anchor-id="traffic-lights"><span class="header-section-number">11.4.2</span> Traffic lights</h3>
<p>Using red, orange and green LEDs, build a traffic light system that responds to temperature:</p>
<ul>
<li>red turns on if <span class="math inline">\(T&gt;30\)</span> °C</li>
<li>orange turns on if <span class="math inline">\(27&lt;T&lt;30\)</span> °C</li>
<li>green turns on if <span class="math inline">\(T&lt;27\)</span> °C</li>
</ul>
</section>
<section id="bonus" class="level3" data-number="11.4.3">
<h3 data-number="11.4.3" class="anchored" data-anchor-id="bonus"><span class="header-section-number">11.4.3</span> Bonus</h3>
<p>Build an PMW-based control system where the duty cycle tempends on temperature.</p>
</section>
</section>
<section id="extra-codes-and-examples" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="extra-codes-and-examples"><span class="header-section-number">11.5</span> Extra codes and examples</h2>
<section id="serial-read-and-blink" class="level3" data-number="11.5.1">
<h3 data-number="11.5.1" class="anchored" data-anchor-id="serial-read-and-blink"><span class="header-section-number">11.5.1</span> Serial read and blink</h3>
<button class="btn btn-outline-dark  rounded" type="button" data-bs-toggle="collapse" data-bs-target="#serial_read_and_blinkino" aria-expanded="false" aria-controls="serial_read_and_blinkino">
    <i class="bi bi-toggles"></i> Toggle code
    </button>
     <a class="btn btn-outline-dark rounded" ,="" href="../archive/code/serial_read_and_blink.ino" download="" target="_blank" rel="noopener noreferrer">
        <i class="bi bi-download"></i> Download code
    </a>

            <div class="collapse" id="serial_read_and_blinkino">
            <div class="card card-body border-0">
        
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">// Define the built-in LED pin</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="pp">#define LED_PIN </span>LED_BUILTIN<span class="pp">  </span><span class="co">// Most ESP32 boards use GPIO 2 for the built-in LED</span></span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="dt">void</span> setup<span class="op">()</span> <span class="op">{</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="co">// Initialize serial communication at 115200 baud</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>  Serial<span class="op">.</span>begin<span class="op">(</span><span class="dv">115200</span><span class="op">);</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>  </span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="co">// Wait for the serial monitor to connect</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="cf">while</span> <span class="op">(!</span>Serial<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>    <span class="op">;</span> <span class="co">// Wait for serial port to connect. Needed for native USB port only</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>  <span class="op">}</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>  </span>
<span id="cb5-13"><a href="#cb5-13"></a>  <span class="co">// Set the LED pin as an output</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>  pinMode<span class="op">(</span>LED_PIN<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>  </span>
<span id="cb5-16"><a href="#cb5-16"></a>  <span class="co">// Print instructions</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>  Serial<span class="op">.</span>println<span class="op">(</span><span class="st">"Enter the number of times you want the LED to blink:"</span><span class="op">);</span></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="op">}</span></span>
<span id="cb5-19"><a href="#cb5-19"></a></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="dt">void</span> loop<span class="op">()</span> <span class="op">{</span></span>
<span id="cb5-21"><a href="#cb5-21"></a>  <span class="co">// Check if data is available to read</span></span>
<span id="cb5-22"><a href="#cb5-22"></a>  <span class="cf">if</span> <span class="op">(</span>Serial<span class="op">.</span>available<span class="op">()</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-23"><a href="#cb5-23"></a>    <span class="co">// Read the integer from the serial monitor</span></span>
<span id="cb5-24"><a href="#cb5-24"></a>    <span class="dt">int</span> blinkCount <span class="op">=</span> Serial<span class="op">.</span>parseInt<span class="op">();</span></span>
<span id="cb5-25"><a href="#cb5-25"></a>    </span>
<span id="cb5-26"><a href="#cb5-26"></a>    <span class="co">// Check if the parsed integer is greater than 0</span></span>
<span id="cb5-27"><a href="#cb5-27"></a>    <span class="cf">if</span> <span class="op">(</span>blinkCount <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-28"><a href="#cb5-28"></a>      <span class="co">// Print the received number</span></span>
<span id="cb5-29"><a href="#cb5-29"></a>      Serial<span class="op">.</span>print<span class="op">(</span><span class="st">"Blinking LED "</span><span class="op">);</span></span>
<span id="cb5-30"><a href="#cb5-30"></a>      Serial<span class="op">.</span>print<span class="op">(</span>blinkCount<span class="op">);</span></span>
<span id="cb5-31"><a href="#cb5-31"></a>      Serial<span class="op">.</span>println<span class="op">(</span><span class="st">" times"</span><span class="op">);</span></span>
<span id="cb5-32"><a href="#cb5-32"></a>      </span>
<span id="cb5-33"><a href="#cb5-33"></a>      <span class="co">// Blink the LED the specified number of times</span></span>
<span id="cb5-34"><a href="#cb5-34"></a>      <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> blinkCount<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb5-35"><a href="#cb5-35"></a>        digitalWrite<span class="op">(</span>LED_PIN<span class="op">,</span> HIGH<span class="op">);</span>  <span class="co">// Turn on the LED</span></span>
<span id="cb5-36"><a href="#cb5-36"></a>        delay<span class="op">(</span><span class="dv">500</span><span class="op">);</span>                   <span class="co">// Wait for 500 milliseconds</span></span>
<span id="cb5-37"><a href="#cb5-37"></a>        digitalWrite<span class="op">(</span>LED_PIN<span class="op">,</span> LOW<span class="op">);</span>   <span class="co">// Turn off the LED</span></span>
<span id="cb5-38"><a href="#cb5-38"></a>        delay<span class="op">(</span><span class="dv">500</span><span class="op">);</span>                   <span class="co">// Wait for 500 milliseconds</span></span>
<span id="cb5-39"><a href="#cb5-39"></a>      <span class="op">}</span></span>
<span id="cb5-40"><a href="#cb5-40"></a>      </span>
<span id="cb5-41"><a href="#cb5-41"></a>      <span class="co">// Print done message</span></span>
<span id="cb5-42"><a href="#cb5-42"></a>      Serial<span class="op">.</span>println<span class="op">(</span><span class="st">"Done blinking"</span><span class="op">);</span></span>
<span id="cb5-43"><a href="#cb5-43"></a>    <span class="op">}</span></span>
<span id="cb5-44"><a href="#cb5-44"></a>  <span class="op">}</span></span>
<span id="cb5-45"><a href="#cb5-45"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

            </div>
            </div>
            


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../tutorials/electronics-class-2.html" class="pagination-link" aria-label="Electronics Class 2">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Electronics Class 2</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../tutorials/digital-read-write.html" class="pagination-link" aria-label="Reading digital and analog">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Reading digital and analog</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>